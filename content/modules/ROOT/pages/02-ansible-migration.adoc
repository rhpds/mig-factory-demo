= VM Migration with the Ansible Automation Platform

*SAY:*

In the previous module, you saw how easy it is to migrate VMs from VMware to OpenShift Virtualization using the Migration Toolkit for Virtualization.

While this process is effective and doesn’t take too long to complete, how can we speed up the process and achieve scale when needed?

Here, we introduce Ansible Automation Platform (AAP) to the mix.

== Ansible Automation Platform

Let me show you how easy it is to migrate from VMware to OpenShift Virtualization with Ansible Automation Platform.

image::module-02/mtv_ansible_architecture_01.png[]

Here we have an architectural diagram showcasing each phrase from day Zero to day two of the VM life cycle.

The focus today is on day one and how we can leverage the abilities of the Migration Toolkit for Virtualization and Ansible Automation Platform to simplify this process and automate the migration.

// To start the migration first we need to determine what VMS we wish to migrate.

// Within the vSphere client UI I've identified those as win web01 and win web 02.

// The next thing I need to do is within the OpenShift web UI, I need to set up the prerequisites to have a successful migration.

// This includes the provider, the virtual plan, and setting up the network and storage maps.

// This is what that process looks like manually.  (Fast Forward)

The manual process is effective and took us just a few minutes to prepare, how can we speed up this process and that scale when needed to do that we introduce Ansible Automation Platform to the mix?

*DO:*

. Navigate to the link:{aap_controller_web_url}[AAP Controller^]
.. Log in if necessary:
* *Username:* {aap_controller_admin_user}
* *Password:* {aap_controller_admin_password}

. Click on *Templates* in the left menu, and then click on *01 Migrate VMware VMs to OpenShift Virtualization*.

. Click *Launch*.

*SAY:*
With our job template already in place that handles all the prerequisites all we need to do is answer a few simple questions in our fully customizable anable survey, such as the names of the VMS to migrate and we are often running.

We've already migrated the database VM and the webserver, now let's migrate the failover webserver.
*DO:*

. Enter the name of the VM you would like to migrate into the Ansible survey.
+
----
winweb02
----

. Click *Next* to continue.

. Click *Launch* to start the migration process.
+
TIP: The display might not refresh automatically.
Refresh your browser to see the Ansible Job Output.

*SAY:*

This time we can see the process just takes us a little less than 30 seconds to complete.

image:module-02/migration_job_elapsed_time.png[]

We can now take a look at the migration Job template itself and see it's running and setting up everything for us such as the provider creation the network and storage maps and even the virtual plan itself.

*DO:*

. Click on *Jobs* on the left menu, and then click on the most recent run of *01 Migrate VMware VMs to OpenShift Virtualization*.

. Navigate to the link:{openshift_web_console}[OpenShift Console^]

//. Select the appropriate *Project* that's the target of the migration.

. Click *Migration* in the left menu, and then click *Providers for Virtualization*.

image:module-02/ansible_migration_plan.png[]

*SAY:*

Now within the OpenShift UI you can see everything has been pre-created for us because of Ansible Automation Platform.

*DO:*

Click on *Plans for Virtualization* on the left menu, and show how another migration plan has been created.

*SAY:*

This includes the virtual machines winweb01 and winweb02 and their corresponding IDs that are built into the virtual plan when we filled out the Ansible survey.

*DO:*

. Click on the *Plans for virtualization* on the left menu, and indicate the new plan created by AAP.

. Click on the *NetworkMaps for virtualization* on the left menu, and indicate the new network map created by AAP.

. Click on the *StorageMaps for virtualization* on the left menu, and indicate the new storage map created by AAP.

. Return to the *Plans for virtualization* on the left menu, and click on the name of the `migration-plan`.

. Click on the *YAML* tab, and highlight the names of the virtual machines to be migrated, on or about lines 65 through 90 in the YAML.

*SAY:*

The VM migration plan has already been Started for you.
If you prefer, the Ansible Automation can simply set up these resources and rely on you to click the *Start* button.

////
*DO:*

. Again click on *Plans for virtualization* on the left menu, and click the *Start* button on the right, and cofirm by clicking *Start* in the modal box that opens.
////

*SAY:*

With AAP you have total control of how and what you want to automate not to mention the increased speed in reducing the number of manual steps taking away the human error element by automating your workflows and having consistency as you scale out your migration process.

== Summary

*SAY:*

In this demo, we used the Ansible Automation Platform to migrate our VMs to OpenShift Virtualization, bringing automation to the process and all the benefits that come with it: speed, scale, and consistency.

Furthermore, we can now easily integrate this process with other automation workflows and automate the lifecycle of your virtual machines.
While Day 2 and Day 3 operations are not covered in this demo, there are separate resources available to assist you with those.

In addition to the Migration Toolkit for Virtualization, there are three other migration toolkits.

The combination of these can be used to move many types of workloads into and within OpenShift clusters depending on your organization’s needs.

For more information about these other migration toolkits, please reach out to your Red Hat account team.

*DO:*

NOTE: Please delete this demo from the Red Hat Demo Platform as soon as you have completed practicing or delivering the demo to your customer.
